<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
    "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="generator" content="AsciiDoc 8.2.2" />
<style type="text/css">
/* Debug borders */
p, li, dt, dd, div, pre, h1, h2, h3, h4, h5, h6 {
/*
  border: 1px solid red;
*/
}

body {
  margin: 1em 5% 1em 5%;
}

a {
  color: blue;
  text-decoration: underline;
}
a:visited {
  color: fuchsia;
}

em {
  font-style: italic;
}

strong {
  font-weight: bold;
}

tt {
  color: navy;
}

h1, h2, h3, h4, h5, h6 {
  color: #527bbd;
  font-family: sans-serif;
  margin-top: 1.2em;
  margin-bottom: 0.5em;
  line-height: 1.3;
}

h1 {
  border-bottom: 2px solid silver;
}
h2 {
  border-bottom: 2px solid silver;
  padding-top: 0.5em;
}

div.sectionbody {
  font-family: serif;
  margin-left: 0;
}

hr {
  border: 1px solid silver;
}

p {
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}

pre {
  padding: 0;
  margin: 0;
}

span#author {
  color: #527bbd;
  font-family: sans-serif;
  font-weight: bold;
  font-size: 1.1em;
}
span#email {
}
span#revision {
  font-family: sans-serif;
}

div#footer {
  font-family: sans-serif;
  font-size: small;
  border-top: 2px solid silver;
  padding-top: 0.5em;
  margin-top: 4.0em;
}
div#footer-text {
  float: left;
  padding-bottom: 0.5em;
}
div#footer-badges {
  float: right;
  padding-bottom: 0.5em;
}

div#preamble,
div.tableblock, div.imageblock, div.exampleblock, div.verseblock,
div.quoteblock, div.literalblock, div.listingblock, div.sidebarblock,
div.admonitionblock {
  margin-right: 10%;
  margin-top: 1.5em;
  margin-bottom: 1.5em;
}
div.admonitionblock {
  margin-top: 2.5em;
  margin-bottom: 2.5em;
}

div.content { /* Block element content. */
  padding: 0;
}

/* Block element titles. */
div.title, caption.title {
  font-family: sans-serif;
  font-weight: bold;
  text-align: left;
  margin-top: 1.0em;
  margin-bottom: 0.5em;
}
div.title + * {
  margin-top: 0;
}

td div.title:first-child {
  margin-top: 0.0em;
}
div.content div.title:first-child {
  margin-top: 0.0em;
}
div.content + div.title {
  margin-top: 0.0em;
}

div.sidebarblock > div.content {
  background: #ffffee;
  border: 1px solid silver;
  padding: 0.5em;
}

div.listingblock {
  margin-right: 0%;
}
div.listingblock > div.content {
  border: 1px solid silver;
  background: #f4f4f4;
  padding: 0.5em;
}

div.quoteblock > div.content {
  padding-left: 2.0em;
}

div.attribution {
  text-align: right;
}
div.verseblock + div.attribution {
  text-align: left;
}

div.admonitionblock .icon {
  vertical-align: top;
  font-size: 1.1em;
  font-weight: bold;
  text-decoration: underline;
  color: #527bbd;
  padding-right: 0.5em;
}
div.admonitionblock td.content {
  padding-left: 0.5em;
  border-left: 2px solid silver;
}

div.exampleblock > div.content {
  border-left: 2px solid silver;
  padding: 0.5em;
}

div.verseblock div.content {
  white-space: pre;
}

div.imageblock div.content { padding-left: 0; }
div.imageblock img { border: 1px solid silver; }
span.image img { border-style: none; }

dl {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
dt {
  margin-top: 0.5em;
  margin-bottom: 0;
  font-style: italic;
}
dd > *:first-child {
  margin-top: 0;
}

ul, ol {
    list-style-position: outside;
}
ol.olist2 {
  list-style-type: lower-alpha;
}

div.tableblock > table {
  border: 3px solid #527bbd;
}
thead {
  font-family: sans-serif;
  font-weight: bold;
}
tfoot {
  font-weight: bold;
}

div.hlist {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
div.hlist td {
  padding-bottom: 5px;
}
td.hlist1 {
  vertical-align: top;
  font-style: italic;
  padding-right: 0.8em;
}
td.hlist2 {
  vertical-align: top;
}

@media print {
  div#footer-badges { display: none; }
}

div#toctitle {
  color: #527bbd;
  font-family: sans-serif;
  font-size: 1.1em;
  font-weight: bold;
  margin-top: 1.0em;
  margin-bottom: 0.1em;
}

div.toclevel1, div.toclevel2, div.toclevel3, div.toclevel4 {
  margin-top: 0;
  margin-bottom: 0;
}
div.toclevel2 {
  margin-left: 2em;
  font-size: 0.9em;
}
div.toclevel3 {
  margin-left: 4em;
  font-size: 0.9em;
}
div.toclevel4 {
  margin-left: 6em;
  font-size: 0.9em;
}
/* Workarounds for IE6's broken and incomplete CSS2. */

div.sidebar-content {
  background: #ffffee;
  border: 1px solid silver;
  padding: 0.5em;
}
div.sidebar-title, div.image-title {
  font-family: sans-serif;
  font-weight: bold;
  margin-top: 0.0em;
  margin-bottom: 0.5em;
}

div.listingblock div.content {
  border: 1px solid silver;
  background: #f4f4f4;
  padding: 0.5em;
}

div.quoteblock-content {
  padding-left: 2.0em;
}

div.exampleblock-content {
  border-left: 2px solid silver;
  padding-left: 0.5em;
}

/* IE6 sets dynamically generated links as visited. */
div#toc a:visited { color: blue; }
</style>
<title>HG-BUILDPACKAGE(1)</title>
</head>
<body>
<div id="header">
<h1>HG-BUILDPACKAGE(1)</h1>
<span id="author">Michael Gebetsroither</span><br />
<span id="email"><tt>&lt;<a href="mailto:michael.geb@gmx.at">michael.geb@gmx.at</a>&gt;</tt></span><br />
</div>
<h2>NAME</h2>
<div class="sectionbody">
<p>hg-buildpackage - helper program to maintain Debian packages with mercurial</p>
</div>
<h2>SYNOPSIS</h2>
<div class="sectionbody">
<p><strong>hg-buildpackage</strong> [ -mq / -mqd / tag ] [ &lt;options_for_dpkg-buildpackage&gt; ]</p>
</div>
<h2>DESCRIPTION</h2>
<div class="sectionbody">
<p>This manual page documents briefly the <strong>hg-buildpackage</strong> command.</p>
<p><strong>hg-buildpackage</strong> is a simple wrapper script to maintain Debian packages with mercurial (AKA hg).</p>
</div>
<h2>OPTIONS</h2>
<div class="sectionbody">
<dl>
<dt>
<strong>-mq</strong>
</dt>
<dd>
<p>
If upstream sources are not found in upstream directory, try to get it out of the repos itself (version must been tagged).
</p>
</dd>
<dt>
<strong>-mqd</strong>
</dt>
<dd>
<p>
Additionally to -mq use the available mercurial patch queue (from the default location .hg/patches) for the package and convert it to dpatch for easier package contributions for external developers.
</p>
</dd>
<dt>
<strong>tag</strong>
</dt>
<dd>
<p>
This tags the repos, increments the changelog by 1 and sets distribution to unreleased.
</p>
</dd>
</dl>
</div>
<h2>USAGE WITH MQ</h2>
<div class="sectionbody">
<p>The options -mq and -mqd are intended for non nativ debian package which have a tracking repos and a versioned mercurial patch queue.</p>
<h3>Prerequisites</h3>
<p>To keep hg-buildpackage as simple as possible there is a number of prerequisites in this build mode.</p>
<p>The first patch in the queue should be the debian patch, and it should be applied before execution of hg-buildpackage.</p>
<p>If commandline option -mpd is given, all patches in the queue which are not allready applied are converted to the dpatch system. The necessarry infrastructure for dpatch should allready be available (best from the allready applied debian patch).</p>
<p>All patches touching files from upstream should be handled through dpatch (thats the reason why the debian patch should be the first patch in the queue).</p>
</div>
<h2>Semi-Automatic tagging</h2>
<div class="sectionbody">
<p>If you use <strong>hg-buildpackage</strong> tag some things will happen:</p>
<ul>
<li>
<p>
Tag the repository with the package version from the changelog
</p>
</li>
<li>
<p>
Increase debian release by 1
</p>
</li>
<li>
<p>
Set distribution to unreleased
</p>
</li>
</ul>
</div>
<h2>FILES</h2>
<div class="sectionbody">
<p><strong>~/.hgbuildpackage</strong></p>
<p>When executing hg-buildpackage it sources the file ~/.hgbuildpackage if it exists. You can overwrite all environment variables used inside
hg-buildpackage and used for BUILD_COMMAND this way. What you might want to set and adjust are the variables UPSTREAM and BUILD_COMMAND.</p>
<p>You can use pbuilder or cowbuilder for building packages. If you set
BUILD_MODE to "pbuilder" or "cowbuilder" the one you choosed will be used, if
set to "local" dpkg-buildpackage will be used. Per default sudo will be used
to call pbuilder and cowbuilder, if you don't like this set ROOT_COMMAND
to the one you like.</p>
<p>Example for ~/.hgbuildpackage:</p>
<div class="listingblock">
<div class="content">
<pre><tt>  # where the upstream sources are
  UPSTREAM=/home/mika/grml/hg/upstream/

  # define the build command
  BUILD_COMMAND="dpkg-buildpackage -k37E272E8 -sa -rfakeroot"

  # use cowbuilder
  BUILD_MODE="cowbuilder"

  # use sudo for getting root (this is the default)
  ROOT_COMMAND="sudo"

  # call lintian after building
  LINTIAN="true"</tt></pre>
</div></div>
</div>
<h2>EXAMPLES WITH MQ</h2>
<div class="sectionbody">
<p>Short command sequence to modify a patch from a package (eg. zzuf)</p>
<div class="listingblock">
<div class="content">
<pre><tt>  hg clone http://hg.grml.org/zzuf
  hg clone http://hg.grml.org/zzuf zzuf/.hg/patches
  cd zzuf
  hg qpush
  vi debian/rules
  [make some changes]
  hg qrefresh
  hg qcommit -m 'made some modifications to debian/rules'
  cd .hg/patches
  hg push</tt></pre>
</div></div>
</div>
<h2>SEE ALSO</h2>
<div class="sectionbody">
<p>hg(1), hgmergevim(1), hgr(1), hg-mirror(1), hg-cleantree(1)</p>
</div>
<h2>AUTHOR</h2>
<div class="sectionbody">
<p>hg-buildpackage was written by Alexander Wirt &lt;formorer@grml.org&gt;, with mq support from Michael Gebetsroither &lt;gebi@grml.org&gt;</p>
<p>This manual page was original written by Michael Prokop &lt;mika@grml.org&gt; and converted to asciidoc from Michael Gebetsroither &lt;gebi@grml.org&gt;</p>
</div>
<div id="footer">
<div id="footer-text">
Last updated 27-Jul-2008 04:31:32 CEST
</div>
</div>
</body>
</html>
